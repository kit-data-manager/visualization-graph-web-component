import { Meta, Canvas, Story, ArgsTable } from '@storybook/addon-docs/blocks';
import * as VisualizationComponentStories from './visualization-component.stories';

<Meta title="Introduction/Visualization Component" />

# Visualization Component

The `visualization-component` is a dynamic, interactive graph component built using D3.js library. It is designed to render graphs based on provided JSON data, making it ideal for visualizing complex relationships and networks in an intuitive manner. There are features that allows users to customize color, description, label dynamically.The component also supports various interactive features like hover effects, node dragging, and click events to reveal connections between entities. This makes it an excellent tool for exploring and understanding intricate data relationships.

## Data Format and Connection Representation

The `visualization-component` requires data in a specific JSON format to accurately represent and visualize relationships between entities. Here's an overview of the data format and how connections are established:

### JSON Data Model

The component accepts an array of objects, where each object represents an entity with a unique identifier and a set of properties. The structure is as follows:

```json
[
  {
    "id": "Unique Identifier",
    "properties": {
      "propertyName": "propertyValue"
    }
  }
]
```

### How can i map my data to component acceptible data?


Demonstrations of component using simple example

Lets take a simple example of a FAIR DO [Link](https://kit-data-manager.github.io/fairdoscope/?pid=21.T11981/6ab464ed-978b-4996-876f-f68ea913a308)


If you open the link of the FAIR DO you will notice there is a primary id (pid) i.e 21.T11981/6ab464ed-978b-4996-876f-f68ea913a308 and there is PID Information record.
In order to use visualization-component first step should be to model FAIR DO's data to a data format which is acceptible by the component.

Consider this pid to be the equivalent to id in our data model as it is the main identification of the object and the PID information record to be the properties of the data model.

For a short example we will only use few properties from the FAIR DO and map it to our data model.

Now our input data for the component becomes 
```json
[
  {
    "id": "21.T11981/6ab464ed-978b-4996-876f-f68ea913a308",
    "properties": {
      "kernelInformationProfile": "21.T11148/863d938d632b53d62d52",
      "hasMetadata": "21.T11981/73bfcca4-9f2b-4cfc-a003-30f5a51aab84"
    }
  }
]
```
If you see the property "hasMetadata" is also a FAIR DO and it is connected to the initial(parent) FAIR DO and the connection is based on property/key "hasMetadata".
If we integrate "hasMetadata" as a new id to our data model then the data model becomes:

```json
[
  {
    "id": "21.T11981/6ab464ed-978b-4996-876f-f68ea913a308",
    "properties": {
      "kernelInformationProfile": "21.T11148/863d938d632b53d62d52",
      "hasMetadata": "21.T11981/73bfcca4-9f2b-4cfc-a003-30f5a51aab84"
    }
  },
  {
    "id": "21.T11981/73bfcca4-9f2b-4cfc-a003-30f5a51aab84",
    "properties": {
      "kernelInformationProfile": "21.T11148/828b74888f3774d97f73"
    }
  }
]
``` 


To see a better graph of the above example we can some other properties as well in this case the PID Information Record key value pairs.

```json
  [
    {
    "id": "21.T11981/6ab464ed-978b-4996-876f-f68ea913a308",
    "properties": {
      "kernelInformationProfile": "21.T11148/863d938d632b53d62d52",
      "hasMetadata": "21.T11981/73bfcca4-9f2b-4cfc-a003-30f5a51aab84",
      "digitalObjectLocation": "https://b2share.eudat.eu/api/files/5fc88ad5-2f13-483c-8b80-a5862c91dbbb/Biological.tar#L7_dc3e2161576ff12aa04a2f6a4f7bb69a.jpg",
      "version": "1.0.0",
      "digitalObjectType":"21.T11148/1a1e620666cb1713acde",
      "contact": "https://www.scc.kit.edu/personen/14958.php"
    }
  },
  {
    "id": "21.T11981/73bfcca4-9f2b-4cfc-a003-30f5a51aab84",
    "properties": {
      "kernelInformationProfile": "21.T11148/828b74888f3774d97f73",
      "digitalObjectLocation": "http://mm3.datamanager.kit.edu:8040/api/v1/metadata/SEMDataSetV2",
      "dateCreated": "20220605 19:48:04 UTC",
      "checksum": "{ "sha512sum": "653e874977b3695aac75ef20f237cfc25b5cfff1e72bab0c5cbec5ce0eb7fa3b0a6b29049cbfcf0d2e6f961c7a2d5c5ad1ac2b7d83db194f7aba6ab2518ddc9f" }"
    }
  }
]
```
If we use the compoent to visualize above data we will get below result.

<Canvas>
  <Story id="components-visualizationcomponent--first-demo" />
</Canvas>

### Example to demonstrate Ontologies [Link to ontology](https://git.rwth-aachen.de/nfdi-matwerk/ta-oms/iuc17_demonstrator/-/blob/dataset_for_viz/example_dataset/dataset_1/triples?ref_type=heads#L132)

See the below snapshot from the above examplewhich focuses on id: 'https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248'

```JSON
[
  {
    "@id": "https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248",
    "@type": [
      "http://purls.helmholtz-metadaten.de/cmso/Element"
    ],
    "http://purls.helmholtz-metadaten.de/cmso/hasElementRatio": [
      {
        "@type": "http://www.w3.org/2001/XMLSchema#float",
        "@value": "1.0"
      }
    ],
    "http://purls.helmholtz-metadaten.de/cmso/hasSymbol": [
      {
        "@value": "Fe"
      }
    ]
  },
  {
    "@id": "sample:13cab138-c3a0-481d-8c09-2584e24f30ff_ChemicalSpecies",
    "@type": [
      "http://purls.helmholtz-metadaten.de/cmso/ChemicalSpecies"
    ],
    "http://purls.helmholtz-metadaten.de/cmso/hasElement": [
      {
        "@id": "https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248"
      }
    ]
  },
  {
    "@id": "sample:b2421053-c682-4976-a9eb-49efbc4cb463_ChemicalSpecies",
    "@type": [
      "http://purls.helmholtz-metadaten.de/cmso/ChemicalSpecies"
    ],
    "http://purls.helmholtz-metadaten.de/cmso/hasElement": [
      {
        "@id": "https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248"
      }
    ]
  }
]

```

This is how the above data will look like after mapping to visualization-component acceptible form.

```json
  [
    {
    "id": "https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248",
    "properties": {
      "type": "http://purls.helmholtz-metadaten.de/cmso/Element",
      "hasMetadata": "21.T11981/73bfcca4-9f2b-4cfc-a003-30f5a51aab84",
      "hasElementRatio": "1.0",
      "hasSymbol": "Fe",
    }
  },
    {
    "id": "sample:13cab138-c3a0-481d-8c09-2584e24f30ff_ChemicalSpecies",
    "properties": {
      "type": "http://purls.helmholtz-metadaten.de/cmso/ChemicalSpecies",
      "hasElement": "https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248",
      "hasElementRatio": "1.0",
      "hasSymbol": "Fe",
    }
  },
    {
    "id": "sample:b2421053-c682-4976-a9eb-49efbc4cb463_ChemicalSpecies",
    "properties": {
      "type": "http://purls.helmholtz-metadaten.de/cmso/ChemicalSpecies",
      "hasElement": "https://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:18248"
    }
  }
]
```

<Canvas>
  <Story id="components-visualizationcomponent--ontologies-demo" />
</Canvas>

## Support and Contributions

### Reporting Issues

If you encounter any issues, have suggestions for enhancements, or need assistance, please report them on our GitHub repository's issue tracker:

[Report issues](https://github.com/kit-data-manager/visualization-graph-web-component/issues)


### Source Code

The source code for the `visualization-component` is available on GitHub. You can explore the codebase, contribute enhancements, or report issues:

[View source code](https://github.com/kit-data-manager/visualization-graph-web-component)
